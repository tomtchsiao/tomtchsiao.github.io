<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Politics</title>
    <style>
        body {
            font-family: "Times New Roman", "標楷體";
            margin: 0;
            padding: 0;
        }
        header, nav, main, footer {
            padding: 20px;
        }
        header {
            background-color: #4CAF50;
            color: white;
            text-align: center;
        }
        a {
            text-decoration: none;
            color: blue;
        }
        a:hover {
           color: green; 
        }
        a:active{
            color: purple;
        }
        section {
            margin-bottom: 14px;
        }
        footer {
            background-color: #f1f1f1;
            text-align: center;
            font-size: 13px;
        }
        table {
            margin: 0;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid #000;
            padding: 8px;
            text-align: center;
        }
    </style>
</head>
<body>
    <header>
        <h1>Politics</h1>
    </header>
    <main>
            <h2>Announcement</h2>
            <p>
                <b>We consider to add five points to your total grade. Happy lunar new year!</b> <br>
                <span style="color: red">
                Midterm held on Week 09, covered Chapter 01 to 12. <br>
                Final held on Week 15, covered Chapter 13 to 20. <br>
                </span>
                Week 08 and 14 have review lessons, and Week 09 will announced the midterm with reference answers. <br>
                Week 16 will announced the final with reference answers and check the semester grades.
            </p>
            <h2>Course information</h2>
            Instructor: Tzu-Chi Hsiao <br>
            Feel free to  <a href="mailto:tomtchsiao@gmail.com">mail</a> with me. <br>
            Office hours: By appointment. <br>
            Course time: Every Tuesday 09:20-12:10. <br>
            Course location: Room 108, Social Sciences Building, CCU. <br>
            Course limitation: 95 students. <br>
            <h2>Textbook</h2>
            Politics, Andrew Heywood, Newest edition. <br>
            <h2>Teaching assistant</h2>
            <p>
                <a href="mailto:b134330001@ntu.edu.tw">Lin-Shan Chen</a> <br>
                <a href="mailto:b134330026@ntu.edu.tw">Yu-Wei Lin</a> <br>
                <a href="mailto:b134330032@ntu.edu.tw">Tzu-Hsuan Huang</a> <br>
            </p>
            <h2>Why taking this course</h2>
            A. Realize your life. <br>
            B. Understand what is the value we urging for. <br>
            C. Learning by solving problems. <br>
            <h2>Prerequisite</h2>
            &bull; English reading. <br>
            &bull; High school civics. <br>
            &bull; <b>Time management</b>. <br>
            <h2>Handouts</h2>
            <a href="handout/overview/overview.pdf">Course Overview</a> <br>
            <a href="handout/01/01.pdf">Chapter 01</a> <br>
            <a href="handout/02/02.pdf">Chapter 02</a> <br>
            <a href="handout/03/03.pdf">Chapter 03</a> <br>
            <a href="handout/04/04.pdf">Chapter 04</a> <br>
            <a href="handout/05/05.pdf">Chapter 05</a> <br>
            <a href="handout/06/06.pdf">Chapter 06</a> <br>
            <a href="handout/07/07.pdf">Chapter 07</a> <br>
            <a href="handout/08/08.pdf">Chapter 08</a> <br>
            <a href="handout/09/09.pdf">Chapter 09</a> <br>
            <a href="handout/10/10.pdf">Chapter 10</a> <br>
            <a href="handout/11/11.pdf">Chapter 11</a> <br>
            <a href="handout/12/12.pdf">Chapter 12</a> <br>
            <a href="handout/mid/mid.pdf">Midterm Review</a> <br>
            <a href="handout/13/13.pdf">Chapter 13</a> <br>
            <a href="handout/14/14.pdf">Chapter 14</a> <br>
            <a href="handout/15/15.pdf">Chapter 15</a> <br>
            <a href="handout/16/16.pdf">Chapter 16</a> <br>
            <a href="handout/17/17.pdf">Chapter 17</a> <br>
            <a href="handout/18/18.pdf">Chapter 18</a> <br>
            <a href="handout/19/19.pdf">Chapter 19</a> <br>
            <a href="handout/20/20.pdf">Chapter 20</a> <br>
            <a href="handout/summary/summary.pdf">Summary</a> <br>
            <a href="handout/fin/fin.pdf">Final Review</a>
            <h2>Sample exams</h2>
            <a href="exam/exam.pdf">Sample exam</a>
            <h2>Grade table</h2>
            <p>
                &bull; Assignments costs 25%, Midterm costs 35%, and Final costs 40%. <br>
                &bull; We use <b>eCourse2</b> to grade your works.
            </p>
            <p>
                &bull; Assignment forms list in below. <br>
                Each costs 5% in semesters grading. <br>
                We have 25 multiple choices problems between two to five options (Each problem costs 4%).
            </p>
            <p>
                &bull; Exam forms list in below. <br>
                A. True or False. (30 points, Each 3%) <br>
                B. Explanation.  (35 points, Each 5%) <br>
                C. Short essay. (35 points, Each 10%, 25%) <br>
                
                &bull; Using <b>Mandarin</b> to answer in clearly. <br>
            </p>
            <table id="gradesTable"> 
                <tr>
                    <td>ID</td>
                    <td>HW #1</td>
                    <td>HW #2</td>
                    <td>HW #3</td>
                    <td>HW #4</td>
                    <td>HW #5</td>
                    <td>Midterm</td>
                    <td>Final</td>
                    <td>Total</td>
                </tr>
                <tr>
                    <td>493___001</td>
                    <td class="hw">92</td>
                    <td class="hw">88</td>
                    <td class="hw">100</td>
                    <td class="hw">100</td>
                    <td class="hw">96</td>
                    <td class="mid">87</td>
                    <td class="final">89</td>
                    <td class="total">0</td>
                </tr>
    </table>
    <button id="exportBtn">Export this table sheet</button>
    </main>
    <footer>
    <p>&copy; Politics;</p>
</footer>
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script>
   const weights = { // Weights of this course. Each costs 50% is well to detect performance.
    hw:0.25,
    mid: 0.35,
    final: 0.4
};
function calculateTotal() {
    const table = document.getElementById('gradesTable');
    const rows = table.getElementsByTagName('tr');
    for (let i = 1; i < rows.length; i++) { // Add by each rows.
        const hwElems = rows[i].querySelectorAll('.hw');
        const midElem = rows[i].querySelector('.mid');
        let mid = Math.min(parseFloat(midElem.textContent), 100);
        midElem.textContent = mid;
        const finalElem = rows[i].querySelector('.final');
        let final = Math.min(parseFloat(finalElem.textContent), 100);
        finalElem.textContent = final;
        let totalScore = 0; 
        let hwTotal = 0;
        let hwCount = 0;
        for (let j = 0; j < hwElems.length; j++) {
            let hwScore = Math.min(parseFloat(hwElems[j].textContent), 100);
            hwTotal += hwScore;
            hwCount++;
        }
        let hwAverage = hwTotal / hwCount;
        totalScore = hwAverage * weights.hw + mid * weights.mid + final * weights.final;
        totalScore += 5; //Add by performance.
        if (totalScore > 100) totalScore = 100; // Not exceed 100.
        const totalCell = rows[i].querySelector('.total');
        totalCell.textContent = Math.round(totalScore); 
        }
    }
    function exportToExcel() { // Export to Excel file and upload to system by hand.
        const table = document.getElementById('gradesTable');
        const wb = XLSX.utils.table_to_book(table, {sheet: "sheet"});
        XLSX.writeFile(wb, 'grades_Politics_Required.xlsx');
    }
    document.addEventListener('DOMContentLoaded', function() {
        calculateTotal();
        document.getElementById('exportBtn').addEventListener('click', exportToExcel);
    });
</script>
</body>
</html>
