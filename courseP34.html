<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>課程網頁</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
            color: #333;
        }
        header {
            background-color: #07B341;
            color: #fff;
            padding: 20px 0;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .container {
            width: 80%;
            margin: 20px auto;
            background-color: #fff;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
        }
        h2 {
            text-align: left;
        }
        .section {
            margin-bottom: 20px;
        }
        .section h2 {
            margin: 0;
            padding: 10px;
            color: #2F302F;
            border-radius: 4px 4px 0 0;
            font-weight: normal;
        }
        .section p, .section ul {
            padding: 20px;
            background-color: #f9f9f9;
            border-radius: 0 0 4px 4px;
        }
        .section ul {
            list-style-type: none;
            padding-left: 0;
        }
        .section ul li {
            margin-bottom: 10px;
        }
        footer {
            font-size: 12px;
            text-align: center;
            padding: 5px;
            background-color: #07B341;
            color: #fff;
            position: fixed;
            width: 100%;
            bottom: 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        table, th, td {
            border: 1px solid #ddd;
        }
        th, td {
            padding: 8px;
            text-align: center;
            font-weight: normal;
        }
        th {
            background-color: #f2f2f2;
        }
        .fail {
            color: red;
        }
        .announcement {
            color: red; 
        }
    </style>
</head>
<body>
    <header>
        <h1>Political Science</h1>
    </header>
    <div class="container">
        <div class="section">
            <h2>Course announcement</h2>
            <p>
                If your semester grade is between <span class="fail">57.5</span> to <span class="fail">59.4</span>, you can still pass. (Fully attendance and gain at least 40% in examinations.)
                <br><br>
                Attendance below 67% <span class="fail">cannot</span> take the final examination. (Check school's regulation.)
                <br><br>
                Attendance counts between Week 4 to 15, except Week 8, 12 (Attend a conference, slightly move the process before.) and Week 16.
                <br><br>
                Midterm held on Week 8 and Final held on Week 16.
            </p>
        </div>
        <div class="section">
            <h2>Course outline</h2>
            <p></p>
        </div>
        <div class="section">
            <h2>Course description</h2>
            <p>
                Erect a perfect political thinking way, through telling and taking notes, can be helpful.
            </p>
        </div>
        <div class="section">
            <h2>Grading</h2>
            <ul>
                <li>Attendance: 30%</li>
                <li>Midterm Exam: 35%</li>
                <li>Final Exam: 35%</li>
            </ul>
        </div>
        <div class="section">
            <h2>Handout</h2>
            <p></p>
        </div>
        <div class="section">
                <h2>Grade List</h2>
                <table>
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Midterm</th>
                            <th>Final</th>
                            <th>Attendance</th>
                            <th>Total</th>
                        </tr>
                    </thead>
                    <tbody id="gradesTable">
                        <tr>
                            <td>417330001</td>
                            <td><span class="grade">54</span></td>
                            <td><span class="grade">87</span></td>
                            <td><span class="grade">100</span></td>
                            <td><span class="totalGrade">0</span></td>
                        </tr>
                        <tr>
                            <td>417330002</td>
                            <td><span class="grade">40</span></td>
                            <td><span class="grade">54</span></td>
                            <td><span class="grade">100</span></td>
                            <td><span class="totalGrade">0</span></td>
                        </tr>
                        <tr>
                            <td>417330003</td>
                            <td><span class="grade">78</span></td>
                            <td><span class="grade">82</span></td>
                            <td><span class="grade">100</span></td>
                            <td><span class="totalGrade">0</span></td>
                        </tr>
                        <tr>
                            <td>417330004</td>
                            <td><span class="grade">53</span></td>
                            <td><span class="grade">48</span></td>
                            <td><span class="grade">100</span></td>
                            <td><span class="totalGrade">0</span></td>
                        </tr>
                        <tr>
                            <td>417330005</td>
                            <td><span class="grade">47</span></td>
                            <td><span class="grade">42</span></td>
                            <td><span class="grade">100</span></td>
                            <td><span class="totalGrade">0</span></td>
                        </tr>
                        <tr>
                            <td>417330006</td>
                            <td><span class="grade">39</span></td>
                            <td><span class="grade">43</span></td>
                            <td><span class="grade">100</span></td>
                            <td><span class="totalGrade">0</span></td>
                        </tr>
                        <tr>
                            <td>417330007</td>
                            <td><span class="grade">40</span></td>
                            <td><span class="grade">40</span></td>
                            <td><span class="grade">100</span></td>
                            <td><span class="totalGrade">0</span></td>
                        </tr>
                        <tr>
                            <td>417330008</td>
                            <td><span class="grade">100</span></td>
                            <td><span class="grade">100</span></td>
                            <td><span class="grade">100</span></td>
                            <td><span class="totalGrade">0</span></td>
                        </tr>
                    </tbody>
                </table>
                <p>Average: <span id="classAverage">0</span></p>
                <p>Standard Deviation: <span id="classStdDev">0</span></p>
                <p>Pass Rate: <span id="passRate">0</span>%</p>
                <button onclick="exportCSV()">Export CSV</button>
            </div>   
        <div class="section">
            <h2>Reference answer</h2>
            <p></p>
        </div>
    </div>
    <footer>
        <p>&copy; Political Science. All rights reserved.</p>
    </footer>
    <script>
        function calculateTotal() {
            const rows = document.querySelectorAll('#gradesTable tr');
            let totalGrades = [];
            let passCount = 0;
            rows.forEach(row => {
                const grades = row.querySelectorAll('.grade');
                let total = 0;
                grades.forEach((grade, index) => {
                    let gradeValue = parseFloat(grade.innerText);
                    if (index === 0 || index === 1) {
                        total += gradeValue * 0.35;
                    } 
                    if (index === 2) {
                        total += gradeValue * 0.3;
                    }
                });
                total = Math.round(total); 
                if (total === 58 ||total === 59) total = 60;
                const totalGradeElement = row.querySelector('.totalGrade');
                totalGradeElement.innerText = total;
                totalGrades.push(total);
                if (total < 60) {
                    totalGradeElement.classList.add('fail');
                } 
                else {
                    totalGradeElement.classList.remove('fail');
                    passCount++;
                }
            });
            const sum = totalGrades.reduce((a, b) => a + b, 0);
            const average = sum / totalGrades.length;
            document.getElementById('classAverage').innerText = average.toFixed(2);
            const variance = totalGrades.reduce((a, b) => a + Math.pow(b - average, 2), 0) / totalGrades.length;
            const stdDev = Math.sqrt(variance);
            document.getElementById('classStdDev').innerText = stdDev.toFixed(2);
            const passRate = (passCount / totalGrades.length) * 100;
            document.getElementById('passRate').innerText = passRate.toFixed(2);
        }
        function exportCSV() {
            const rows = document.querySelectorAll('#gradesTable tr');
            let csvContent = "data:text/csv;charset=utf-8,ID,Midterm,Final,Attendance,Total\n";
            rows.forEach(row => {
                const cells = row.querySelectorAll('td');
                let rowContent = [];
                cells.forEach(cell => {
                    rowContent.push(cell.innerText);
                });
                csvContent += rowContent.join(",") + "\n";
            });
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "Grades.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
        calculateTotal();
    </script>
</body>
</html>